"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7635],{3905:(e,n,t)=>{t.d(n,{Zo:()=>s,kt:()=>d});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},p=Object.keys(e);for(r=0;r<p.length;r++)t=p[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);for(r=0;r<p.length;r++)t=p[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=r.createContext({}),m=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},s=function(e){var n=m(e.components);return r.createElement(i.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},c=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,p=e.originalType,i=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),c=m(t),d=a,k=c["".concat(i,".").concat(d)]||c[d]||u[d]||p;return t?r.createElement(k,o(o({ref:n},s),{},{components:t})):r.createElement(k,o({ref:n},s))}));function d(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var p=t.length,o=new Array(p);o[0]=c;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var m=2;m<p;m++)o[m]=t[m];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}c.displayName="MDXCreateElement"},15818:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>u,frontMatter:()=>p,metadata:()=>l,toc:()=>m});var r=t(87462),a=(t(67294),t(3905));const p={},o="SNMP Exporter",l={unversionedId:"prometheus/Exporter/3.7-snmp-exporter",id:"prometheus/Exporter/3.7-snmp-exporter",title:"SNMP Exporter",description:"\u7ecf\u8fc7\u901a\u8fc7 SNMP \u534f\u8bae\u6765\u76d1\u63a7\u4ea4\u6362\u673a\u3001\u8def\u7531\u5668\u7b49\u7f51\u7edc\u786c\u4ef6\u8bbe\u5907\u3002\u5bf9\u4e8e SNMP \uff0c\u7ef4\u57fa\u767e\u79d1\u7684\u89e3\u91ca\u5982\u4e0b\uff1a",source:"@site/wiki/ops/prometheus/03-Exporter/3.7-snmp-exporter.md",sourceDirName:"prometheus/03-Exporter",slug:"/prometheus/Exporter/3.7-snmp-exporter",permalink:"/zhengxuexian_blog/ops/prometheus/Exporter/3.7-snmp-exporter",draft:!1,tags:[],version:"current",lastUpdatedBy:"zhengxuexian",lastUpdatedAt:1661407442,formattedLastUpdatedAt:"2022\u5e748\u670825\u65e5",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"BlackBox \u7f51\u7edc\u63a2\u6d4b",permalink:"/zhengxuexian_blog/ops/prometheus/Exporter/3.6-blackbox-exporter"},next:{title:"ClickHouse Exporter",permalink:"/zhengxuexian_blog/ops/prometheus/Exporter/3.8-clickhouse-exporter"}},i={},m=[],s={toc:m};function u(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},s,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"snmp-exporter"},"SNMP Exporter"),(0,a.kt)("p",null,"\u7ecf\u8fc7\u901a\u8fc7 SNMP \u534f\u8bae\u6765\u76d1\u63a7\u4ea4\u6362\u673a\u3001\u8def\u7531\u5668\u7b49\u7f51\u7edc\u786c\u4ef6\u8bbe\u5907\u3002\u5bf9\u4e8e SNMP \uff0c\u7ef4\u57fa\u767e\u79d1\u7684\u89e3\u91ca\u5982\u4e0b\uff1a"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u7b80\u5355\u7f51\u7edc\u7ba1\u7406\u534f\u8bae\uff08SNMP\uff0cSimple Network Management Protocol\uff09\u6784\u6210\u4e86\u4e92\u8054\u7f51\u5de5\u7a0b\u5de5\u4f5c\u5c0f\u7ec4\uff08IETF\uff0cInternet Engineering Task Force\uff09\u5b9a\u4e49\u7684Internet\u534f\u8bae\u65cf\u7684\u4e00\u90e8\u5206\u3002\u8be5\u534f\u8bae\u80fd\u591f\u652f\u6301\u7f51\u7edc\u7ba1\u7406\u7cfb\u7edf\uff0c\u7528\u4ee5\u76d1\u6d4b\u8fde\u63a5\u5230\u7f51\u7edc\u4e0a\u7684\u8bbe\u5907\u662f\u5426\u6709\u4efb\u4f55\u5f15\u8d77\u7ba1\u7406\u4e0a\u5173\u6ce8\u7684\u60c5\u51b5\u3002\u5b83\u7531\u4e00\u7ec4\u7f51\u7edc\u7ba1\u7406\u7684\u6807\u51c6\u7ec4\u6210\uff0c\u5305\u542b\u4e00\u4e2a\u5e94\u7528\u5c42\u534f\u8bae\uff08application layer protocol\uff09\u3001\u6570\u636e\u5e93\u6a21\u5f0f\uff08database schema\uff09\uff0c\u548c\u4e00\u7ec4\u8d44\u6599\u5bf9\u8c61\u3002")),(0,a.kt)("p",null,"\u5728\u4e00\u53f0 Linux \u4e3b\u673a\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 snmpwalk \u547d\u4ee4\u6765\u8bbf\u95ee\u8bbe\u5907\u901a\u8fc7 SNMP \u534f\u8bae\u66b4\u9732\u7684\u6570\u636e\uff0c\u6bd4\u5982\u6700\u7b80\u5355\u7684\u67e5\u770b\u6240\u6709\u4fe1\u606f\u7684\u547d\u4ee4\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"snmpwalk -v 2c -c xxxxxxxx 172.16.1.1\n")),(0,a.kt)("p",null,"\u53c2\u6570\u89e3\u91ca\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"-v 2c : \u6307\u5b9a SNMP \u534f\u8bae\u7684\u7248\u672c\uff0c\u5f53\u524d\u6307\u5b9a\u4e3a 2c"),(0,a.kt)("li",{parentName:"ul"},"-c xxxx : SNMP \u7684 Community \u503c"),(0,a.kt)("li",{parentName:"ul"},"172.16.1.1 : \u786c\u4ef6\u7684 IP\u5730\u5740")),(0,a.kt)("p",null,"\u7b80\u5355\u67e5\u770b\u4ee5\u540e\uff0c\u6211\u4eec\u9700\u8981\u957f\u671f\u76d1\u63a7\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u8981\u501f\u52a9 SNMP Exporter \u8fd9\u4e2a\u5de5\u5177\u4e86\u3002"),(0,a.kt)("p",null,"SNMP Exporter \u662f Prometheus \u5f00\u6e90\u7684\u4e00\u4e2a\u652f\u6301 SNMP \u534f\u8bae\u7684\u91c7\u96c6\u5668\uff0cGitHub \u5730\u5740 \uff1a ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/prometheus/snmp_exporter"},"https://github.com/prometheus/snmp_exporter")),(0,a.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7 docker \u90e8\u7f72\u6216\u8005\u4e8c\u8fdb\u5236\u6587\u4ef6\u6765\u8fdb\u884c\u90e8\u7f72"),(0,a.kt)("p",null,"\u4e0b\u8f7d docker image \u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff0c\u4f7f\u7528\u4e2d\u8bf7\u5207\u6362\u5bf9\u5e94\u7684\u7248\u672c\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"docker pull prom/snmp-exporter:v0.20.0\n")),(0,a.kt)("p",null,"\u5982\u679c\u4f7f\u7528\u4e8c\u8fdb\u5236\u6587\u4ef6\u90e8\u7f72 \uff0c\u4e0b\u8f7d\u5730\u5740\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"https://github.com/prometheus/snmp_exporter/releases\n")),(0,a.kt)("p",null,"\u5bf9\u4e8e SNMP Exporter \u7684\u4f7f\u7528\u6765\u8bf4\uff0c \u914d\u7f6e\u6587\u4ef6\u6bd4\u8f83\u91cd\u8981\uff0c\u914d\u7f6e\u6587\u4ef6\u4e2d\u6839\u636e\u786c\u4ef6\u7684 MIB \u6587\u4ef6\u751f\u6210\u4e86 OID \u7684\u6620\u5c04\u5173\u7cfb\u3002\u4ee5 Cisco \u4ea4\u6362\u673a\u4e3a\u4f8b\uff0c\u5728\u5b98\u65b9 GitHub \u4e0a\u4e0b\u8f7d\u6700\u65b0\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"snmp.yml")," \u6587\u4ef6\uff0c\u7531\u4e8e Cisco \u4ea4\u6362\u673a\u4f7f\u7528\u7684\u662f ",(0,a.kt)("inlineCode",{parentName:"p"},"if_mib")," \u6a21\u5757\uff0c\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"if_mib")," \u4e0b\u65b0\u589e ",(0,a.kt)("inlineCode",{parentName:"p"},"auth")," \uff0c\u7528\u6765\u5728\u8bf7\u6c42\u4ea4\u6362\u673a\u7684\u65f6\u5019\u505a\u9a8c\u8bc1\u4f7f\u7528\uff0c\u8fd9\u4e2a\u503c\u662f\u914d\u7f6e\u5728\u4ea4\u6362\u673a\u4e0a\u7684\u3002"),(0,a.kt)("p",null,"\u5173\u4e8e\u91c7\u96c6\u7684\u76d1\u63a7\u9879\u662f\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"walk")," \u5b57\u6bb5\u4e0b\uff0c\u5982\u679c\u8981\u65b0\u589e\u76d1\u63a7\u9879\uff0c\u5199\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"walk")," \u9879\u4e0b\u3002\u6211\u65b0\u589e\u4e86\u4ea4\u6362\u673a\u7684 CPU \u548c\u5185\u5b58\u4fe1\u606f\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"......\n\nif_mib:\n  auth:\n    community: xxxx\n  walk:\n  - 1.3.6.1.2.1.2\n  - 1.3.6.1.2.1.31.1.1\n  - 1.3.6.1.4.1.9.2.1  # \u4ea4\u6362\u673a CPU \u76f8\u5173\u4fe1\u606f\n  - 1.3.6.1.4.1.9.9.48  # \u4ea4\u6362\u673a\u5185\u5b58\u76f8\u5173\u4fe1\u606f\n  get:\n  - 1.3.6.1.2.1.1.3.0\n  metrics:\n  - name: busyPer\n    oid: 1.3.6.1.4.1.9.2.1.56.0\n    type: gauge\n    help: CPU utilization\n  - name: avgBusy1\n    oid: 1.3.6.1.4.1.9.2.1.57.0\n    type: gauge\n    help: CPU utilization in the past 1 minute\n  - name: avgBusy2\n    oid: 1.3.6.1.4.1.9.2.1.58.0\n    type: gauge\n    help: CPU utilization in the past 5 minute\n  - name: MemoryPoolFree\n    oid: 1.3.6.1.4.1.9.9.48.1.1.1.6.1\n    type: gauge\n    help: ciscoMemoryPoolFree\n  - name: MemoryPoolUsed\n    oid: 1.3.6.1.4.1.9.9.48.1.1.1.5.1\n    type: gauge\n    help: ciscoMemoryPoolUsed\n......\n")),(0,a.kt)("p",null,"\u5728 Linux \u7cfb\u7edf\u4e2d\u4f7f\u7528 Docker \u6765\u8fd0\u884c SNMP Exporter \u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u811a\u672c"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"#!/bin/bash\n\ndocker run -d --name snmp-exporter  --restart=always -m 1g \\\n    --volume /erdong/snmp-exporter/conf:/config \\\n    --network host prom/snmp-exporter:v0.20.0 \\\n    --web.listen-address :9107 \\\n    --config.file=/config/snmp.yml\n")),(0,a.kt)("p",null,"\u5728 Linux \u7cfb\u7edf\u90e8\u7f72\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4f7f\u7528\u7cfb\u7edf\u7684 Systemd \u6765\u63a7\u5236\u670d\u52a1\u542f\u505c\uff0c\u7cfb\u7edf\u670d\u52a1\u6587\u4ef6\u53ef\u4ee5\u8fd9\u4e48\u5199\uff0c \u8be5\u811a\u672c\u6e90\u81ea\u5b98\u65b9\u63d0\u4f9b\u7684\u811a\u672c\uff0c\u76f8\u6bd4\u4e8e\u5b98\u65b9\u811a\u672c\u589e\u52a0\u4e86SNMP Exporter \u8fd0\u884c\u7aef\u53e3\u7684\u6307\u5b9a\u3002\u6587\u4ef6 snmp_exporter.service \u7684\u5185\u5bb9\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'[Unit]\nDescription=SNMP Exporter\nAfter=network-online.target\n\n# This assumes you are running snmp_exporter under the user "prometheus"\n\n[Service]\nUser=prometheus\nRestart=on-failure\nExecStart=/usr/local/prometheus/snmp_exporter/snmp_exporter --config.file=/usr/local/prometheus/snmp_exporter/snmp.yml --web.listen-address=:9116\n\n[Install]\nWantedBy=multi-user.target\n')),(0,a.kt)("p",null,"\u8d77\u52a8\u597d\u4ee5\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbf\u95ee http://localhost:9116 \u6765\u67e5\u770b\u542f\u52a8\u7684 SNMP Exporter \uff0c\u9875\u9762\u4e0a\u4f1a\u663e\u793a ",(0,a.kt)("inlineCode",{parentName:"p"},"Target"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"Module"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"Submit"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"Config")," \u8fd9\u51e0\u4e2a\u9009\u9879\u548c\u6309\u94ae\u3002"),(0,a.kt)("p",null,"\u5728 ",(0,a.kt)("inlineCode",{parentName:"p"},"Target")," \u4e2d\u586b\u5199\u4ea4\u6362\u673a\u7684\u5730\u5740\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"Module")," \u91cc\u9009\u62e9\u5bf9\u5e94\u7684\u6a21\u5757\uff0c\u7136\u540e\u70b9\u51fb ",(0,a.kt)("inlineCode",{parentName:"p"},"Submit")," \u8fd9\u6837\u53ef\u4ee5\u67e5\u5230\u5bf9\u5e94\u7684\u76d1\u63a7\u6307\u6807\uff0c\u6765\u9a8c\u8bc1\u91c7\u96c6\u662f\u5426\u6210\u529f\u3002"),(0,a.kt)("p",null,"\u6216\u8005\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"curl")," \u547d\u4ee4\u6765\u9a8c\u8bc1\uff0c\u547d\u4ee4\u683c\u5f0f\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"curl http://localhost:9116/snmp?module=if_mib&target=192.168.2.2\n")),(0,a.kt)("p",null,"\u70b9\u51fb ",(0,a.kt)("inlineCode",{parentName:"p"},"Config")," \u4f1a\u663e\u793a\u5f53\u524d ",(0,a.kt)("inlineCode",{parentName:"p"},"snmp.yml")," \u7684\u914d\u7f6e\u5185\u5bb9\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u4e0a\u8fb9\u9a8c\u8bc1\u6ca1\u6709\u95ee\u9898\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u914d\u7f6e Prometheus \u8fdb\u884c\u91c7\u96c6\u4e86\u3002"),(0,a.kt)("p",null,"Prometheus  \u914d\u7f6e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"  - job_name: NET-SW\n    static_configs:\n      - targets: \n          - 192.168.2.2  # \u601d\u79d1\u4ea4\u6362\u673a\u7684 IP \u5730\u5740\n    metrics_path: /snmp\n    params:\n      module: \n        - if_mib  # \u5982\u679c\u662f\u5176\u4ed6\u8bbe\u5907\uff0c\u8bf7\u66f4\u6362\u5176\u4ed6\u6a21\u5757\u3002\n      community:\n        - xxxxxx  #  \u6307\u5b9a community\uff0c\u5f53 snmp_exporter snmp.yml \u914d\u7f6e\u6587\u4ef6\u6ca1\u6709\u6307\u5b9a community\uff0c\u6b64\u5904\u5b9a\u4e49\u7684 community \u751f\u6548\u3002\n    relabel_configs:\n      - source_labels: [__address__]\n        target_label: __param_target\n      - source_labels: [__param_target]\n        target_label: instance\n      - target_label: __address__\n        replacement: 192.168.1.2:9116  # SNMP Exporter  \u7684\u5730\u5740\u548c\u7aef\u53e3\n")),(0,a.kt)("p",null,"\u914d\u7f6e\u597d Prometheus \u4ee5\u540e\u542f\u52a8 Prometheus \u670d\u52a1 \uff0c\u5c31\u53ef\u4ee5\u67e5\u5230 Cisco \u4ea4\u6362\u673a\u7684\u76d1\u63a7\u4fe1\u606f\u4e86\u3002"),(0,a.kt)("p",null,"\u63a5\u4e0b\u6765\u5c31 Prometheus \u914d\u7f6e\u544a\u8b66\u89c4\u5219\uff0cGrafana \u8fdb\u884c\u753b\u56fe\u4e86\u3002\u8fd9\u4e9b\u64cd\u4f5c\u548c\u5176\u4ed6\u7ec4\u4ef6\u5e76\u65e0\u533a\u522b\uff0c\u5c31\u4e0d\u518d\u8d58\u8ff0\u3002"),(0,a.kt)("h1",{id:"\u624b\u52a8\u751f\u6210-snmpyml-\u914d\u7f6e\u6587\u4ef6"},"\u624b\u52a8\u751f\u6210 ",(0,a.kt)("inlineCode",{parentName:"h1"},"snmp.yml")," \u914d\u7f6e\u6587\u4ef6"),(0,a.kt)("p",null,"\u4e0a\u8fb9\u5728\u914d\u7f6e SNMP Exporter \u7684\u914d\u7f6e\u6587\u4ef6\u7684\u65f6\u5019\uff0c\u4f7f\u7528\u4e86\u5b98\u65b9\u63d0\u4f9b\u7684\u9ed8\u8ba4\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"snmp.yml")," \uff0c\u6709\u4e9b\u8bbe\u5907\u5b98\u65b9\u7684\u914d\u7f6e\u91cc\u5e76\u6ca1\u6709\u652f\u6301\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u901a\u8fc7 MIB \u6587\u4ef6\u6765\u81ea\u5df1\u751f\u6210\u4e86\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u770b\u770b\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u600e\u4e48\u751f\u6210\u3002"),(0,a.kt)("p",null,"\u5b98\u65b9\u5f53\u524d\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"snmp.yml")," \u652f\u6301 \u5982\u4e0b\u8fd9\u4e9b\u6a21\u5757","[2021.04.28]"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"apcups  \uff1a \u4e00\u822c\u7528\u4e8e UPS \u76d1\u63a7\narista_sw\ncisco_wlc \uff1a \u4e00\u822c\u7528\u4e8e ap \u76d1\u63a7\nddwrt  \uff1a \u4e00\u822c\u7528\u4e8e\u8f6f\u8def\u7531\nif_mib  \uff1a \u4e00\u822c\u7528\u4e8e\u7f51\u7edc\u8bbe\u5907\u3002\u8be5MIB\u63cf\u8ff0\u4e86\u7f51\u7edc\u63a5\u53e3\u5b50\u5c42\u7684\u901a\u7528\u8868\u9879\u3002\u662fMIB-II\u4e2difTable\u7684\u5347\u7ea7\u7248\u672c\uff0c\u4e5f\u662f\u5bf9RFC1573\u6269\u5c55\u5b9a\u4e49\u7684\u5177\u4f53\u8bf4\u660e\u3002IF-MIB\u5305\u542b\u4e86\u4e00\u7ec4\u4e0e\u7f51\u7edc\u8bbe\u5907\u7684\u901a\u7528\u63a5\u53e3\u76f8\u5173\u7684\u7ba1\u7406\u5bf9\u8c61\u3002\u8fd9\u4e9b\u7ba1\u7406\u5bf9\u8c61\u9002\u7528\u4e8e\u6240\u6709\u7684\u7f51\u7edc\u63a5\u53e3\uff0c\u4e0e\u63a5\u53e3\u4e0a\u4f7f\u7528\u7684\u901a\u4fe1\u4ecb\u8d28\u5408\u534f\u8bae\u7684\u7c7b\u578b\u65e0\u5173\u3002IF-MIB\u4e5f\u5b9a\u4e49\u4e86\u7528\u4e8e\u7279\u6b8a\u4ecb\u8d28\u548c\u4f4e\u5c42\u534f\u8bae\u6808\uff08\u5b50\u7f51\u5c42\u6216\u66f4\u4f4e\u5c42\uff09\u7684\u7ba1\u7406\u5bf9\u8c61\u3002\ninfrapower_pdu\nkeepalived\nkemp_loadmaster\nliebert_pdu\nmikrotik\nnec_ix\npaloalto_fw\nprinter_mib\nraritan\nservertech_sentry3\nservertech_sentry4\nsynology\nubiquiti_airfiber\nubiquiti_airmax\nubiquiti_unifi\nwienner_mpod\n")),(0,a.kt)("h1",{id:"\u591a\u673a\u5668\u4e0d\u540c\u6a21\u5757\u5982\u4f55\u91c7\u96c6"},"\u591a\u673a\u5668\u4e0d\u540c\u6a21\u5757\u5982\u4f55\u91c7\u96c6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"  - job_name: snmp\n    scrape_interval: 30s # \u8986\u76d6\u5168\u5c40\u9ed8\u8ba4\u503c\n    scrape_timeout: 5s # \u8986\u76d6\u5168\u5c40\u9ed8\u8ba4\u503c\n    file_sd_configs:\n      - files:\n        - /etc/prometheus/file_sd/snmp_device.yml # \u6307\u5b9a snmp \u670d\u52a1\u53d1\u73b0\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\n    metrics_path: /snmp\n    params:\n      module:\n      - if_mib   # \u6307\u5b9a\u9ed8\u8ba4\u91c7\u96c6 MIB \u6a21\u5757\u7684\u540d\u79f0\n      community:\n      - xxxxx  \u6307\u5b9a community\uff0c\u5f53 snmp_exporter snmp.yml \u914d\u7f6e\u6587\u4ef6\u6ca1\u6709\u6307\u5b9a community\uff0c\u6b64\u5904\u5b9a\u4e49\u7684 community \u751f\u6548\u3002 \u7f3a\u7701\u503c\u4e00\u822c\u662f public \u3002\n    relabel_configs:\n    - source_labels:\n      - __address__\n      target_label: __param_target\n    - source_labels:\n      - __param_target\n      target_label: instance\n    - replacement: snmp_exporter:9116\n      target_label: __address__\n    - source_labels:  # \u4ece\u76ee\u6807\u4e2d\u83b7\u53d6MIB\u6a21\u5757\u540d\u79f0\n      - mib\n      target_label: __param_module\n")),(0,a.kt)("p",null,"snmp_device.yml \u7684\u5185\u5bb9\u53c2\u7167\u5982\u4e0b\u683c\u5f0f\u5373\u53ef\u3002\u6211\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\u6dfb\u52a0\u4e86architecture\u4e0emodel\u7b49\u53d8\u91cf\uff0c\u8fd9\u4e9b\u53d8\u91cfprometheus\u83b7\u53d6\u76ee\u6807\u4fe1\u606f\u662f\uff0c\u4f1a\u4f5c\u4e3a\u76ee\u6807\u7684\u6807\u7b7e\u4e0e\u76ee\u6807\u7ed1\u5b9a\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'[\n    {\n        "labels": {\n            "mib": "if_mib",\n            "brand": "Huawei",\n            "hostname": "BJ-LG-HW5328",\n            "model": "S5328C-EI"\n        },\n        "targets": [\n            "192.168.100.1"\n        ]\n    },\n    {\n        "labels": {\n            "mib": "if_mib",\n            "brand": "Huawei",\n            "hostname": "SH-GQ-HW9306CSS",\n            "model": "Quidway S9306"\n        },\n        "targets": [\n            "192.168.100.2"\n        ]\n    },\n    {\n        "labels": {\n            "mib": "if_mib",\n            "brand": "Huawei",\n            "hostname": "BJ-LG-HW9306CSS",\n            "model": "Quidway S9306"\n        },\n        "targets": [\n            "192.168.100.3"\n        ]\n    },\n    {\n        "labels": {\n            "mib": "if_mib",\n            "brand": "Huawei",\n            "hostname": "GZ-RMZ-HW9306CSS",\n            "model": "Quidway S9306"\n        },\n        "targets": [\n            "192.168.100.4"\n        ]\n    }\n]\n')),(0,a.kt)("p",null,"ifOutOctets \u548c ifInOctets \u7684\u6307\u6807\u8bf4\u660e\uff0c\u8fd9\u662f\u4e00\u4e2a\u5386\u53f2\n",(0,a.kt)("a",{parentName:"p",href:"http://www.net-snmp.org/docs/mibs/interfaces.html"},"http://www.net-snmp.org/docs/mibs/interfaces.html")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"\u83b7\u53d6MIB\u53ef\u4ee5\u5728\u4e0b\u9762\u7684 GitHub \u91cc\u9762\u627e\u3002\u8fd9\u4e2a\u91cc\u9762\u6709\u5f88\u591a\u57fa\u7840\u7684MIB")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/librenms/librenms/tree/master/mibs"},"https://github.com/librenms/librenms/tree/master/mibs")))}u.isMDXComponent=!0}}]);